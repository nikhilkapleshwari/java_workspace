package com.dao;

import java.net.UnknownHostException;

import com.mongodb.BasicDBObject;
import com.mongodb.DB;
import com.mongodb.DBCollection;
import com.mongodb.Mongo;
import com.mongodb.MongoClient;

public class PlainMongoDbConnector implements DbConnector {

	private String server;
	private Integer port;
	
	PlainMongoDbConnector(String server,Integer port){
		this.server=server;
		this.port=port;
	}
	
	private MongoClient getMongoClient() {
		try {
			return new MongoClient(this.server,this.port);
		} catch (UnknownHostException e) {
			e.printStackTrace();
			return null;
		}
	}
	
	public void insert(Object object) {
		DB db = this.getMongoClient().getDB("EasyTapp");
		BasicDBObject document = new BasicDBObject();
		document.put("id", "1");
		document.put("name","Nikhil");
		document.put("salary","1000");
		DBCollection table = db.getCollection("User");
		table.insert(document);
	}
	
}
